# B"H


I have a very important task for you. 

## Your Task

Review `.sandbox/deep-research-01/01-get-data.ipynb` in-depth.

I need you to add a cell that runs the following SQL query and saves it to RAW_TAG_VALUES_CSV_FILE.

```sql
select   'faro:deployment'        as selected_tag_key,
         tags['faro:deployment']  as selected_tag_val, 
         tags                     as all_tags,
         LENGTH(TO_VARCHAR(TAGS)) as all_tags_length,
         project_id,
         type_name as resource_type_name,
         resource_id,
from     pointfive.PUBLIC_04228E05471D420B8AE64178958706C9.STG_POINTFIVE__RESOURCES
where    tags['faro:deployment'] is not null
         --
         qualify ROW_NUMBER() OVER (
             partition by selected_tag_key, selected_tag_val
             ORDER BY all_tags_length desc
         ) = 1
         --
order by selected_tag_val
; 
```

Utilize the utility python script: `src/layer_1_util_modules/snowflake_util`

Update `src/layer_1_util_modules/snowflake_util` if needed to make this work in the best way possible!

## Final Notes

Use your best judgement on this task! Be rational, use common sense!

Keep things super simple! Keep thing as simple as possible! Do NOT over-engineer it! no fluff! 
      
ultrathink on this task! This is a super crucial task!